plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'ratio',newpage = F,control = list(log_epsilon=0.25,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=0.25,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=0.0001,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'ic_log',newpage = F,control = list(log_epsilon=1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'ratio',newpage = F,control = list(log_epsilon=1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=0.1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=0.5,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(epsilon=1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(epsilon=0.1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(epsilon=0.25,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(epsilon=1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(epsilon=0.1,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(epsilon=0.2,gap_xlab=3))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(epsilon=0.2,gap_xlab=3,gap_ylab=3.5))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'Effector domain ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'pse'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(epsilon=0.2,gap_xlab=3,gap_ylab=3.5))
citation("motifStack")
m=cbind(c(14,6,8,3),c(2,3,0,26),c(24,1,3,3),c(27,2,0,2),c(0,3,0,28),c(1,7,4,19),c(15,0,16,0),c(11,8,11,1),c(24,0,4,3),c(3,0,1,27),c(2,1,1,27),c(25,2,2,2))
color_profile = list("type" = "per_row",
"col" = RColorBrewer::brewer.pal(4,name ="Spectral"))
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(2,layout.cols), rep("null", layout.cols)),
heights=unit(rep(2,1), rep("null",1))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(m,type = 'pse'),color_profile = color_profile,frame_width = 1,newpage = F,control=list(gap_xlab=3))
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(m,type='pse'),logoheight = 'log',color_profile = color_profile,frame_width = 1,newpage = F,control = list(gap_xlab=3))
readprotein=function(file,skip=3,nrows,nsites,bg=bg,adash,mat){
library(dash)
rawdata=read.table(file = file,skip = skip,nrows = nrows)
if(mat=='pfm'){
pwm=as.matrix(rawdata[,23:42]/100)
pfm=round(pwm*nsites)
colnames(pfm)=c('A' ,'R','N','D',   'C' ,  'Q',   'E' ,  'G',   'H' ,  'I',   'L' , 'K'  , 'M' ,  'F',   'P' ,  'S'  , 'T' ,  'W',   'Y',   'V')
rownames(pfm)=1:nrow(pfm)
return(t(pfm))
}
if(mat=='pwm'){
pwm=as.matrix(rawdata[,23:42]/100)
pfm=round(pwm*nsites)
if(adash==T){
pwm=dash(as.matrix(pfm),mode = bg,optmethod = 'mixEM')$posmean
}
colnames(pwm)=c('A' ,'R','N','D',   'C' ,  'Q',   'E' ,  'G',   'H' ,  'I',   'L' , 'K'  , 'M' ,  'F',   'P' ,  'S'  , 'T' ,  'W',   'Y',   'V')
rownames(pwm)=1:nrow(pwm)
return(t(pwm))
}
if(mat=='pssm'){
pssm=as.matrix(rawdata[,3:22])
colnames(pssm)=c('A' ,'R','N','D',   'C' ,  'Q',   'E' ,  'G',   'H' ,  'I',   'L' , 'K'  , 'M' ,  'F',   'P' ,  'S'  , 'T' ,  'W',   'Y',   'V')
rownames(pssm)=1:nrow(pssm)
return(t(pssm))
}
if(mat=='pssm_median'){
pssm=as.matrix(rawdata[,3:22])
pssm=apply(pssm,2,function(x){x-median(x)})
colnames(pssm)=c('A' ,'R','N','D',   'C' ,  'Q',   'E' ,  'G',   'H' ,  'I',   'L' , 'K'  , 'M' ,  'F',   'P' ,  'S'  , 'T' ,  'W',   'Y',   'V')
rownames(pssm)=1:nrow(pssm)
return(t(pssm))
}
}
pssm1= readprotein('http://caps.ncbs.res.in/cgi-bin/mini/databases/3pfdb/3pfdb_pssm_download.cgi?id=PF06445&data_dir=SDB_folder',nrows = 161,nsites = 100,adash = FALSE,mat='pfm')
pssm=pssm1[,19:26]
colnames(pssm)=1:ncol(pssm)
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
color_profile <- list("type" = "per_row",
"col" = cols1)
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'prop'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'prop'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=0.25,gap_xlab=3))
pssm=pssm1[,10:17]
colnames(pssm)=1:ncol(pssm)
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
color_profile <- list("type" = "per_row",
"col" = cols1)
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'prop'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'prop'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=0.25,gap_xlab=3))
pssm=pssm1[,1:8]
colnames(pssm)=1:ncol(pssm)
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
color_profile <- list("type" = "per_row",
"col" = cols1)
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'prop'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'prop'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=0.25,gap_xlab=3))
pssm=pssm1[,153:160]
colnames(pssm)=1:ncol(pssm)
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
color_profile <- list("type" = "per_row",
"col" = cols1)
grid.newpage()
layout.rows <- 1
layout.cols <- 2
top.vp <- viewport(layout=grid.layout(layout.rows, layout.cols,
widths=unit(rep(6,layout.cols), rep("null", 2)),
heights=unit(c(20,50), rep("lines", 2))))
plot_reg <- vpList()
l <- 1
for(i in 1:layout.rows){
for(j in 1:layout.cols){
plot_reg[[l]] <- viewport(layout.pos.col = j, layout.pos.row = i, name = paste0("plotlogo", l))
l <- l+1
}
}
plot_tree <- vpTree(top.vp, plot_reg)
pushViewport(plot_tree)
seekViewport(paste0("plotlogo", 1))
logomaker(getpwm(pssm,type = 'prop'),color_profile = color_profile,newpage = F,control = list(gap_xlab=3),pop_name = 'A1 Propeptide ')
seekViewport(paste0("plotlogo", 2))
nlogomaker(getpwm(pssm,type = 'prop'),color_profile = color_profile,logoheight = 'log',newpage = F,control = list(log_epsilon=0.25,gap_xlab=3))
library(devtools) # Load the devtools package
install_github("microbiome/microbiome") # Install the package
install.packages('phyloseq')
library(devtools) # Load the devtools package
install_github("microbiome/microbiome") # Install the package
library(phyloseq)
install.packages('bioformat')
library(phyloseq)
install.packages('biomformat')
library(phyloseq)
library.dynam.unload(biomformat)
install.packages("biomformat")
library(biomformat)
setwd("C:/Users/happy/Desktop")
setwd("C:/Users/happy/Desktop/Param_ind5_dir")
